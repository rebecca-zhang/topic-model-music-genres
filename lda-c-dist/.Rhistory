cbind(data3$Direction,data3$Lag2)
cbind(as.integer(data3$Direction)-1,data3$Lag2)
predict(glm.out3, cbind(as.integer(data3$Direction)-1,data3$Lag2))
source('~/.active-rstudio-document')
predict(glm.out3, data.frame(data3$Lag2))
data3 = Weekly[986:1089,]
predict(glm.out3, data.frame(data3$Lag2))
data3$Lag2
data.frame(data3$Lag2)
predict(glm.out3, newdata=data.frame(data3$Lag2))
summary(glm.out3)
x = [1 2 3]
x = c(1,2,3)
x
x*2
+0.3
x*2 + 0.3
predicted = data3$Lag2*0.0581 + 0.20326
predicted
confusionMatrix(predictedBool,as.integer(data3$Direction)-1 >0)
data3$Direction
predictedBool = predicted > 0.5
confusionMatrix(predictedBool,as.integer(data3$Direction)-1 >0)
glm.out3 = glm(as.integer(data2$Direction)-1 ~ data2$Lag2, family=binomial(logit), data=data2)
summary(glm.out3)
glm.out2 = glm(as.integer(Direction)-1 ~ Lag1+Lag2+Lag3+Lag4+Lag5+Volume, family=binomial(logit),data=Weekly)
summary(glm.out2)
predicted2 = 0.26686 - 0.04127*Lag1 +0.05844*Lag2 - 0.01606*Lag3 - 0.02779*Lag4 - 0.01447*Lag5 - 0.02274*Volume
predicted2 = 0.26686 - 0.04127*Weekly$Lag1 +0.05844*Lag2 - 0.01606*Lag3 - 0.02779*Lag4 - 0.01447*Lag5 - 0.02274*Volume
predicted2 = 0.26686 - 0.04127*Weekly$Lag1 +0.05844*Weekly$Lag2 - 0.01606*Weekly$Lag3 - 0.02779*Weekly$Lag4 - 0.01447*Weekly$Lag5 - 0.02274*Weekly$Volume
predictedBool2 = predicted2 > 0.5
confusionMatrix(predictedBool2,as.integer(Weekly$Direction)-1 >0)
predicted = predict(glm.out2)
predictedBool = predicted > 0.5
confusionMatrix(predictedBool,as.integer(Weekly$Direction)-1 >0)
data(Mroz)
glm.out4 = glm(as.integer(lfp)-1 ~. , family=binomial(logit),data=Mroz)
summary(glm.out4)
confusionMatrix(predictedBool,as.integer(Weekly$Direction)-1 >0)
data2 = Weekly[1:985,]
glm.out3 = glm(as.integer(data2$Direction)-1 ~ data2$Lag2, family=binomial(logit), data=data2)
summary(glm.out3)
# y = 0.20326 + 0.0581*Lag2
data3 = Weekly[986:1089,]
predicted = data3$Lag2*0.0581 + 0.20326
predictedBool = predicted > 0.5
confusionMatrix(predictedBool,as.integer(data3$Direction)-1 >0)
lfp
Mroz$lfp
as.integer(lfp)-1
as.integer(Mroz$lfp)-1
summary(glm.out4)
predicted = data3$Lag2*exp(0.0581) + exp(0.20326)
predictedBool = predicted > 0.5
confusionMatrix(predictedBool,as.integer(data3$Direction)-1 >0)
predicted2 = exp(0.26686) - exp(0.04127)*Weekly$Lag1 + exp(0.05844)*Weekly$Lag2 - exp(0.01606)*Weekly$Lag3 - exp(0.02779)*Weekly$Lag4 - exp(0.01447)*Weekly$Lag5 - exp(0.02274)*Weekly$Volume
predictedBool = predicted > 0.5
confusionMatrix(predictedBool,as.integer(Weekly$Direction)-1 >0)
predictedBool2 = predicted2 > 0.5
confusionMatrix(predictedBool2,as.integer(Weekly$Direction)-1 >0)
#1990-2008 data are rows 1-985
data2 = Weekly[1:985,]
glm.out3 = glm(as.integer(data2$Direction)-1 ~ data2$Lag2, family=binomial(logit), data=data2)
summary(glm.out3)
# y = exp(0.20326) + exp(0.0581)*Lag2
data3 = Weekly[986:1089,]
predicted = data3$Lag2*exp(0.0581) + exp(0.20326)
predictedBool = predicted > 0.5
confusionMatrix(predictedBool,as.integer(data3$Direction)-1 >0)
summary(glm.out4)
install.packages('Ecdat')
library(Ecdat)
data(CRSPday)
crsp=CRSPday[,7]
acf(crsp)
acf(as.numeric(crsp))
data(CRSPday)
crsp=CRSPday[,7]
acf(crsp)
acf(crsp)
acf(as.numeric(crsp))
crsp
as.numeric(crsp)
arima(crsp,order=c(1,0,0))
arima(crsp,order=c(2,0,0))
data(jj)
data(jj)
jj
install.packages('astsa')
library(astsa)
install.packages("astsa")
options(install.packages.check.source = FALSE)
install.packages("astsa")
install.packages("/Users/rebeccaz/Downloads/astsa", repos = NULL, type = "source")
library(astsa)
data(jj)
required(astsa)
require(astsa)
arima(crsp,order=c(1,0,0))
arima(crsp,order=c(2,0,0))
library(Ecdat)
data(CRSPday)
crsp=CRSPday[,7]
acf(crsp)
acf(as.numeric(crsp))
install.packages("/Users/rebeccaz/Downloads/astsa", repos = NULL, type = "source")
install.packages("/Users/rebeccaz/Downloads/astsa", repos = NULL, type = "source")
library(astsa)
data(jj)
jj
c(1,0)
c(1 )
c(1 0)
t = rep(c(1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980),each=4)
t
rep(1:4,2)
Q1 = rep(c(1,0,0,0),21)
Q2 = rep(c(0,1,0,0),21)
Q3 = rep(c(0,0,1,0),21)
Q4 = rep(c(0,0,0,1),21)
t = rep(c(1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980),each=4)
Q1
as.vector(jj)
log(as.vector(jj))
lm.fit = lm(x~t+Q1+Q2+Q3+Q4)
lm.fit = lm(x~t+Q1+Q2+Q3+Q4, data=x)
lm.fit = lm(x~t+Q1+Q2+Q3+Q4)
x
y
x = log(as.vector(jj))
x
lm.fit = lm(x~t+Q1+Q2+Q3+Q4)
summary(lm.fit)
lm.fit = lm(x~t+Q1+Q2+Q3+Q4)
summary(lm.fit)
q1
Q1
Q2
Q3
Q4
x
t
summary(lm.fit2)
lm.fit2 = lm(x~intercept+t+Q1+Q2+Q3+Q4)
intercept=rep(c(1,1,1,1),21)
lm.fit2 = lm(x~intercept+t+Q1+Q2+Q3+Q4)
summary(lm.fit2)
x
lm.fit = lm(x~t+Q1+Q2+Q3+Q4+0)
summary(lm.fit)
1960:1961:0.25
seq(0,1,0.25)
seq(1960,1961,0.25)
t = seq(1960,1980.75,0.25)
x = log(as.vector(jj))
lm.fit = lm(x~t+Q1+Q2+Q3+Q4+0)
summary(lm.fit)
t = seq(0,20.75,0.25)
x = log(as.vector(jj))
lm.fit = lm(x~t+Q1+Q2+Q3+Q4+0)
summary(lm.fit)
summary(lm.fit)
lm.fit2 = lm(x~t+Q1+Q2+Q3+Q4)
summary(lm.fit2)
plot(x)
plot(lim.fit.values)
plot(fitted(lm.fit))
par(new=TRUE)
plot(x)
par(new=TRUE)
plot(fitted(lm.fit))
plot(fitted(lm.fit), col = "red")
plot(x)
par(new=TRUE)
plot(fitted(lm.fit), col = "red")
plot(lm.fit)
install.packages("/Users/rebeccaz/Downloads/astsa", repos = NULL, type = "source")
library(astsa)
data(jj)
Q1 = rep(c(1,0,0,0),21)
Q2 = rep(c(0,1,0,0),21)
Q3 = rep(c(0,0,1,0),21)
Q4 = rep(c(0,0,0,1),21)
t = seq(0,20.75,0.25)
x = log(as.vector(jj))
lm.fit = lm(x~t+Q1+Q2+Q3+Q4+0)
summary(lm.fit)
lm.fit2 = lm(x~t+Q1+Q2+Q3+Q4)
summary(lm.fit2)
read.table(paste('likelihood', i, '.txt'))
read.table(paste0('likelihood', i, '.txt'))
read.table(paste0('likelihood', i, '.txt'))
for i from 1:2
for (i in 3:9) {
read.table(paste0('likelihood', i, '.txt'))
}
cwd
wd
pwd
getwd()
setwd('Documents/PrincetonJunior/COS424/FinalProject/lda-c-dist')
getwd()
#read
for (i in 3:9) {
read.table(paste0('likelihood', i, '.txt'))
}
for (i in 3:9) {
read.table(paste0('likelihood', i, '.txt'))
}
for (i in 3:9) {
likelihood = read.table(paste0('likelihood', i, '.txt'))
}
likelihood
hi = matrix(data=NA, nrow=2, ncol = 3)
hi
hi(1,2)
hi[1][2]
hi[1]
likelihood = matrix(data = NA,nrow = 7,ncol = 5)
#read
for (i in 3:9) {
likelihood[i-3] = read.table(paste0('likelihood', i, '.txt'))
}
likelihood
hi[1]
hi
hi[1] = c(1,2,3)
hi[1][] = c(1,2,3)
hi
hi[1] = c(1,2,3)
hi
c(1,2,3)
hi[1,:] = c(1,2,3)
hi[1,] = c(1,2,3)
hi
likelihood = matrix(data = NA,nrow = 7,ncol = 5)
#read
for (i in 3:9) {
likelihood[i-3,] = read.table(paste0('likelihood', i, '.txt'))
}
likelihood
head(likelihood)
likelihood = matrix(nrow = 7,ncol = 5)
#read
for (i in 3:9) {
likelihood[i-3,] = read.table(paste0('likelihood', i, '.txt'))
}
likelihood
likelihood = matrix(nrow = 7,ncol = 5)
#read
for (i in 3:9) {
likelihood[i-3,] = read.table(paste0('likelihood', i, '.txt'), sep=',')
}
likelihood
hi=matrix(nrow=2,ncol=3)
hi
hi[0,] = c(1,2,3)
hi
likelihood = matrix(nrow = 7,ncol = 5)
#read
for (i in 3:9) {
likelihood[i-2,] = read.table(paste0('likelihood', i, '.txt'), sep=',')
}
likelihood
read.table('likelihood3.txt',sep=',')
read.table('likelihood3.txt',sep=',')[1:5]
likelihood = matrix(nrow = 7,ncol = 5)
#read
for (i in 3:9) {
likelihood[i-2,] = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
}
likelihood
read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
likelihood[1,] = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
row = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
row
likelihood[1,]
likelihood
likelihood = matrix(nrow = 7,ncol = 5)
likelihood
likelihood[1,]
likelihood[1,] = row
likelihood
likelihood = matrix(nrow = 7,ncol = 5)
likelihood
likelihood[1,] = read.table(paste0('likelihood', 3, '.txt'), sep=',')[1:5]
likelihood
likelihood = matrix(nrow = 7,ncol = 5)
#read
for (i in 3:9) {
row = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
likelihood[i-2,] = row
}
likelihood = matrix(nrow = 7,ncol = 5)
row = read.table(paste0('likelihood', 3, '.txt'), sep=',')[1:5]
likelihood
row
hi = matrix(0,0)
hi = matrix(nrow = 0,ncol = 0)
hi
likelihood = matrix(nrow = 0,ncol = 0)
#read
for (i in 3:9) {
row = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
likelihood = rbind(likelihood,row)
}
likelihood
likelihoods = matrix(nrow = 0,ncol = 0)
#read
for (i in 3:9) {
row = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
likelihoods = rbind(likelihood,row)
}
blank = c()
blank
blank.append(2)
hi
likelihood[1,]
test = matrix(nrow=2,ncol=2)
test[1,] = c(1,10)
test[2,] = c(2,20)
test
rowMeans(test)
likelihoods
average = rowsMeans(likelihoods)
average = rowMeans(likelihoods)
average
likelihoods = matrix(nrow = 0,ncol = 0)
#read
for (i in 3:9) {
row = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
likelihoods = rbind(likelihood,row)
}
average = rowMeans(likelihoods)
likelihoods
3:9
likelihoods
likelihoods = matrix(nrow = 0,ncol = 0)
#read
for (i in 3:9) {
row = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
likelihoods = rbind(likelihood,row)
likelihoods
}
likelihoods
likelihoods = matrix(nrow = 0,ncol = 0)
row = read.table(paste0('likelihood', 3, '.txt'), sep=',')[1:5]
likelihoods
likelihoods = rbind(likelihood,row)
likelihoods
likelihoods = matrix(nrow = 0,ncol = 0)
likelihoods
row = read.table(paste0('likelihood', 3, '.txt'), sep=',')[1:5]
likelihoods = matrix(nrow = 0,ncol = 0)
#read
for (i in 3:9) {
row = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
likelihoods = rbind(likelihoods,row)
likelihoods
}
average = rowMeans(likelihoods)
average
likelihoods
SD = rowSds(likelihoods)
library(matrixStats)
install.packages("matrixStats")
library(matrixStats)
SD = rowSds(likelihoods)
SD
SD/4
SD*0
SE = SD/sqrt(5)
SE
geom_point()
geom_line()
geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line()
ggplot(dfc, aes(x=dose, y=len, colour=supp)) + geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line()
library(ggplot2)
ggplot(dfc, aes(x=dose, y=len, colour=supp)) + geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line()
geom_point()
geom_line() + geom_point()
geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line() + geom_point()
+ geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line() + geom_point()
ggplot(dfc, aes(x=dose, y=len, colour=supp)) + geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line() + geom_point()
ggplot(average, aes(x=dose, y=len, colour=supp)) + geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line() + geom_point()
ggplot(average) + geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line() + geom_point()
ggplot(average)
average
c(average)
ggplot(c(average))
dataframe(average)
data.frame(average)
show()
ggplot(data.frame(average))
ggplot(data.frame(average))+ geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line() + geom_point()
plot(data.frame(average))
lines(data.frame(average))
lines(data.frame(average))
plot.new()
lines(data.frame(average))
numtopics = ()
numtopics = c()
numtopics.append(4)
append(numtopics,4)
numtopics
likelihoods = matrix(nrow = 0,ncol = 0)
numtopics = c()
#read
for (i in 3:9) {
row = read.table(paste0('likelihood', i, '.txt'), sep=',')[1:5]
likelihoods = rbind(likelihoods,row)
numtopics = append(numtopics,i)
}
average = rowMeans(likelihoods)
numtopics
plot(numtopics,average)
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="n")
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="n")
data$x
data$y
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
install.packages("Hmisc")
library(Hmisc)
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="n")
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
plot(data$x,data$y,type="n",ylim = c(-108000,-103000))
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
plot(data$x,data$y,type="n",ylim = c(-110000,-100000))
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
plot(data$x,data$y,type="n",ylim = c(-110000,-90000))
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
plot(data$x,data$y,type="n",ylim = c(-120000,-90000))
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
plot(data$x,data$y,type="n",ylim = c(-115000,-90000))
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
plot(data$x,data$y,type="n",ylim = c(-115000,-95000))
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
#+ geom_errorbar(aes(ymin=len-se, ymax=len+se), width=.1) + geom_line() + geom_point()
plot(data$x,data$y,type="n",ylim = c(-115000,-95000), type ='o')
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="n",ylim = c(-115000,-95000), type ='o')
plot(data$x,data$y,type="n",ylim = c(-115000,-95000), type ="o")
plot(data$x,data$y,type="n",ylim = c(-115000,-95000), type ="l")
plot(data$x,data$y,type="l",ylim = c(-115000,-95000))
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
title(xlab = "Number of Topics")
title(ylab = "Held-out log likelihood")
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="l",ylim = c(-115000,-95000))
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
title(xlab = "Number of Topics")
title(ylab = "Held-out log likelihood")
plot(data$x,data$y,type="l",ylim = c(-115000,-95000),axes = FALSE)
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
title(xlab = "Number of Topics")
title(xlab = "Number of Topics",ylab = "Held-out log likelihood")
title(main="Cross Validation")
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="l",ylim = c(-115000,-95000),)
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
plot(data$x,data$y,type="l",ylim = c(-115000,-95000),lab = "Number of Topics",ylab = "Held-out log likelihood")
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="l",ylim = c(-115000,-95000),lab = "Number of Topics",ylab = "Held-out log likelihood")
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="l",ylim = c(-115000,-95000),xlab = "Number of Topics",ylab = "Held-out log likelihood")
)
title(main="LDA Cross Validation")
plot(data$x,data$y,type="l",ylim = c(-115000,-95000),xlab = "Number of Topics",ylab = "Held-out log likelihood")
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
title(main="LDA Cross Validation")
title(main="LDA 5-Fold Cross Validation")
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="l",ylim = c(-115000,-95000),xlab = "Number of Topics",ylab = "Held-out log likelihood")
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
title(main="LDA 5-Fold Cross Validation")
data=data.frame(x=numtopics,y=average,sd=SE)
plot(data$x,data$y,type="l",ylim = c(-115000,-95000),xlab = "Number of Topics",ylab = "Held-out log likelihood")
with (
data = data, expr = errbar(x, y, y+sd, y-sd, add=T, pch=1, cap=.1)
)
title(main="LDA Five-Fold Cross Validation")
